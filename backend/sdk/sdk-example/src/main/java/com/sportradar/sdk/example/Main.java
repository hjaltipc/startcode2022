package com.sportradar.sdk.example;

import java.util.Random;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import com.sportradar.sdk.common.exceptions.SdkException;
import com.sportradar.sdk.feed.common.entities.EventIdentifier;
import com.sportradar.sdk.feed.livescout.interfaces.LiveScoutFeed;
import com.sportradar.sdk.feed.livescout.interfaces.LiveScoutFeedListener;
import com.sportradar.sdk.feed.sdk.Sdk;

public class Main {

    private final static Logger logger = LoggerFactory.getLogger(Main.class);

    /**
     * The main entry point for the sdk-example
     *
     * @param args provided command line arguments
     */
    public static void main(String[] args) throws SdkException {

        logger.info("Starting application");

        final Sdk sdk = Sdk.getInstance();
        final LiveScoutFeed liveScoutFeed = sdk.getLiveScout();

        final LiveScoutFeedListener scoutFeedListener = new LiveScoutFeedListenerImpl();

        Random rand = new Random();
        int upperbound = 10000;
        long[] ids = { 27647274L, 27871760L, 27885392L, 28077596L, 28160532L, 28304186L, 31123185L, 31528695L,
                31767683L, 31887911L, 32309731L, 32897901L, 32898607L, 33160035L, 33401021L,
                27647276L, 27871764L, 27886458L, 28077598L, 28160536L, 28304188L, 31123187L, 31528705L, 31767685L,
                31932223L, 32312465L, 32897903L, 32898609L, 33181715L, 33405947L,
                27647280L, 27872640L, 27965830L, 28077600L, 28171156L, 28304190L, 31123191L, 31528723L, 31767687L,
                31932225L, 32319865L, 32897999L, 32898653L, 33184713L, 33406455L,
                27647282L, 27872664L, 27965832L, 28077602L, 28171158L, 28473916L, 31123193L, 31529103L, 31767689L,
                31932227L, 32337395L, 32898001L, 32898655L, 33195141L, 33419243L,
                27647284L, 27872666L, 27965834L, 28077616L, 28171160L, 28619748L, 31123199L, 31529107L, 31767691L,
                31932229L, 32337409L, 32898111L, 32898673L, 33195955L, 33433647L,
                27647300L, 27872668L, 27965842L, 28078216L, 28171162L, 28619756L, 31123201L, 31561513L, 31767693L,
                31932237L, 32536477L, 32898113L, 32898675L, 33243817L, 33433683L,
                27751734L, 27872672L, 27965844L, 28078218L, 28171164L, 28619762L, 31181239L, 31561515L, 31767695L,
                31933831L, 32536479L, 32898211L, 32898695L, 33296905L, 33436385L,
                27751738L, 27872676L, 27965862L, 28078226L, 28171166L, 28619764L, 31181245L, 31561517L, 31767701L,
                32038679L, 32536593L, 32898213L, 32898697L, 33296907L, 33443169L,
                27751744L, 27872678L, 27973866L, 28153626L, 28171168L, 30903643L, 31181247L, 31561519L, 31769007L,
                32038683L, 32536603L, 32898235L, 32898721L, 33296909L, 33443175L,
                27751748L, 27883652L, 27973868L, 28153628L, 28171170L, 30982339L, 31181249L, 31561521L, 31769015L,
                32038685L, 32536605L, 32898237L, 32898723L, 33296939L, 33467693L,
                27752678L, 27883678L, 27973874L, 28153632L, 28171172L, 31000889L, 31197143L, 31561523L, 31769027L,
                32038693L, 32698575L, 32898263L, 32946187L, 33300345L, 33467695L,
                27752684L, 27884672L, 27973880L, 28153640L, 28260428L, 31019117L, 31404643L, 31602923L, 31787009L,
                32055781L, 32809805L, 32898265L, 32946191L, 33300351L, 33467697L,
                27752690L, 27884676L, 27973882L, 28153648L, 28260434L, 31019119L, 31404647L, 31602925L, 31787011L,
                32284631L, 32810109L, 32898453L, 32946195L, 33300353L, 33467699L,
                27752694L, 27885366L, 27973886L, 28153652L, 28260446L, 31019121L, 31404651L, 31602929L, 31787013L,
                32284633L, 32811653L, 32898455L, 33063077L, 33300357L, 33467701L,
                27824448L, 27885368L, 27973902L, 28160510L, 28304174L, 31019123L, 31404655L, 31602935L, 31787015L,
                32284641L, 32811657L, 32898527L, 33137681L, 33311525L, 33467703L,
                27824450L, 27885372L, 27975356L, 28160514L, 28304176L, 31095577L, 31404659L, 31602937L, 31787017L,
                32284645L, 32811663L, 32898529L, 33137685L, 33313531L, 33480789L,
                27824468L, 27885374L, 27975376L, 28160516L, 28304178L, 31095635L, 31404661L, 31603087L, 31787021L,
                32284651L, 32811917L, 32898547L, 33137689L, 33314959L, 33483573L,
                27824474L, 27885376L, 28041858L, 28160518L, 28304180L, 31099641L, 31404677L, 31605777L, 31787023L,
                32307387L, 32811921L, 32898549L, 33137691L, 33364319L, 33487389L,
                27870286L, 27885378L, 28041860L, 28160522L, 28304182L, 31099699L, 31404963L, 31605779L, 31799369L,
                32307389L, 32897877L, 32898567L, 33159941L, 33380043L, 33489437L,
                27871756L, 27885384L, 28041872L, 28160528L, 28304184L, 31123183L, 31528693L, 31605783L, 31803127L,
                32307411L, 32897879L, 32898569L, 33159943L, 33395219L, 33497623L };

        if (liveScoutFeed != null) {
            liveScoutFeed.open(scoutFeedListener);
        }

        try {
            boolean close = false;
            while (!close && liveScoutFeed != null) {
                for (long id : ids) {
                    int messageDelay = (rand.nextInt(upperbound) + 1000);
                    liveScoutFeed.subscribeToTest(EventIdentifier.id(id), messageDelay, 0);
                }
            }
        } catch (Exception e) {
            logger.error("Error: ", e);
        }

        sdk.close();
    }
}